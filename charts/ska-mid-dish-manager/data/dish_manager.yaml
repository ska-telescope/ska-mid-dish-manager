name: "dishmanager-{{.Release.Name}}"
function: telescope-monitoring
domain: general-monitoring
command: "/usr/local/bin/DishManagerDS "
server:
  name: "DishManagerDS"
  instances:
  {{- range  .Values.coalesced_dishes }}
    - name: "{{ . }}"
      classes:
        - name: "DishManager"
          devices:
            - name: "ska{{ printf "%01s" . }}/elt/master"
              properties:
                - name: "ReceptorNumber"
                  values:
                    - "{{ printf "%01s" . }}"
                - name: "SkaLevel"
                  values:
                    - "1"
                - name: "LoggingTargetsDefault"
                  values:
                    - "tango::logger"
                - name: "LoggingLevelDefault"
                  values:
                    - "5"
                - name: "MaxCapabilities"
                  values:
                    - "BANDS:6"
                - name: "GroupDefinitions"
                  values:
                    - ""
                - name: "DSDeviceFqdn"
                  values:
    {{ if $.Values.dishmanager.ds.fqdn }}
                    - "{{ $.Values.dishmanager.ds.fqdn}}"
    {{ else }}
                    - "ska{{ printf "%01s" . }}/{{ $.Values.dishmanager.ds.family_name }}/{{ $.Values.dishmanager.ds.member_name }}"
    {{ end }}
                - name: "SPFDeviceFqdn"
                  values:
    {{ if $.Values.dishmanager.spf.fqdn }}
                    - "{{ $.Values.dishmanager.spf.fqdn}}"
    {{ else }}
                    - "ska{{ printf "%01s" . }}/{{ $.Values.dishmanager.spf.family_name }}/{{ $.Values.dishmanager.spf.member_name }}"
    {{ end }}
                - name: "SPFRxDeviceFqdn"
                  values:
    {{ if $.Values.dishmanager.spfrx.fqdn }}
                    - "{{ $.Values.dishmanager.spfrx.fqdn}}"
    {{ else }}
                    - "ska{{ printf "%01s" . }}/{{ $.Values.dishmanager.spfrx.family_name }}/{{ $.Values.dishmanager.spfrx.member_name }}"
    {{ end }}
                - name: "DishId"
                  values:
                    - "SKA{{ printf "%01s" . }}"
  {{- end }}
depends_on:
  - device: sys/database/2
image:
  registry: "{{.Values.dishmanager.image.registry}}"
  image: "{{.Values.dishmanager.image.image}}"
  tag: "{{.Values.dishmanager.image.tag}}"
  pullPolicy: "{{.Values.dishmanager.image.pullPolicy}}"
